webpackJsonp([8],{PtWS:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("/o5o"),o=r("cMGX"),l={components:{modal:a.a,pagination:o.a},data:function(){return{total:0,pageCount:1,currentPage:1,pageSize:10,loadingFlag:!1,addModalFlag:!1,editModalFlag:!1,removeModalFlag:!1,tableData:[],salesArr:[],clientNameArr:[],clientTypeArr:[],productArr:[],followUpTypeArr:[],orderId:"",orderForm:{contractNo:"",salesId:"",clientNameId:"",clientTypeId:"",orderDate:"",purchasing:"",productId:"",receivables:0,billingDate:"",actuallyArrived:0,paymentDate:"",production:"",followUpTypeId:"",shipDate:"",arrivalDate:"",waybillNumber:"",shipping:0,courierCompany:""},salesId:"",formLabelWidth:"120px",modalWidth:"600px",rules:{contractNo:[{required:!0,message:"请输入合同编号",trigger:"blur"}],sales:[{required:!0,message:"请选择销售代表",trigger:"blur"}],clientName:[{required:!0,message:"请选择客户名称",trigger:"blur"}],clientType:[{required:!0,message:"请选择客户类型",trigger:"blur"}],product:[{required:!0,message:"请选择产品名称",trigger:"blur"}],production:[{required:!0,message:"请填入生产下单",trigger:"blur"}],followUpType:[{required:!0,message:"请选择跟单类型",trigger:"blur"}],waybillNumber:[{required:!0,message:"请录入运单号",trigger:"blur"}],courierCompany:[{required:!0,message:"请输入快递公司",trigger:"blur"}]}}},created:function(){this.loadingData()},computed:{},mounted:function(){},watch:{},methods:{handleSelectionChange:function(){},clickpageNum:function(){},modalChange:function(){this.addModalFlag=!1,this.removeModalFlag=!1,this.editModalFlag=!1},addModal:function(){this.addModalFlag=!0,this.getClientType(),this.getClientName(),this.getSaler(),this.getProductName(),this.getFollowUpType(),this.getOrderDade(),this.getBillingDate(),this.getPaymentDate(),this.getArrivalDate()},showEditModal:function(){},selectedSalesKey:function(e){this.salesId=e},selectedClientNameKey:function(e){this.orderForm.clientNameId=e,console.log("clientNameId  "+this.orderForm.clientNameId)},selectedClientTypeKey:function(e){this.orderForm.clientTypeId=e},selectedFollowUpTypeKey:function(e){this.orderForm.followUpTypeId=e},selectedProductKey:function(e){this.orderForm.productId=e},getOrderDade:function(e){this.orderForm.orderDate=e},getBillingDate:function(e){this.orderForm.billingDate=e},getPaymentDate:function(e){this.orderForm.paymentDate=e},getShipDate:function(e){this.orderForm.shipDate=e},getArrivalDate:function(e){this.orderForm.arrivalDate=e},getSaler:function(){var e=this;this.$ajax.get("/users/").then(function(t){var r=t.data.result;e.salesArr=r})},getClientType:function(){var e=this;this.$ajax.get("/clients/type").then(function(t){var r=t.data.result;e.clientTypeArr=r})},getClientName:function(){var e=this;this.$ajax.get("/clients/").then(function(t){var r=t.data.result;e.clientNameArr=r})},getProductName:function(){var e=this;this.$ajax.get("/product/").then(function(t){var r=t.data.result;e.productArr=r})},getFollowUpType:function(){var e=this;this.$ajax.get("/order/type").then(function(t){var r=t.data.result;e.followUpTypeArr=r})},handlePurchasingChange:function(){},loadingData:function(){var e=this;this.loadingFlag=!0,this.$ajax.get("/order/").then(function(t){e.loadingFlag=!1;var r=t.data.result;console.log("data   "+r);for(var a=[],o=0;o<r.length;o++){var l={_id:r[o]._id,contractNo:r[o].contractNo,clientName:r[o].client.clientName,clientType:r[o].clientType.clientType,courierCompany:r[o].courierCompany,followUpType:r[o].followUpType.orderType,productName:r[o].product.productName,productNum:r[o].product.productNum,productPrice:r[o].product.productPrice+"元",production:r[o].production,purchasing:r[o].purchasing,receivables:r[o].receivables,actuallyArrived:r[o].actuallyArrived,sales:r[o].sales.account,shipping:r[o].shipping,waybillNumber:r[o].waybillNumber,arrivalDate:r[o].arrivalDate,billingDate:r[o].billingDate,orderDate:r[o].orderDate,paymentDate:r[o].paymentDate,shipDate:r[o].shipDate,updatedAt:r[o].updatedAt,createdAt:r[o].createdAt};a.push(l)}e.tableData=a,e.total=a.length})},addOrder:function(e){var t=this;console.log("addOrder"),this.$refs[e].validate(function(e){if(!e)return!1;t.$ajax.post("/order/add",{contractNo:t.orderForm.contractNo,salesId:t.orderForm.salesId,clientNameId:t.orderForm.clientNameId,clientTypeId:t.orderForm.clientTypeId,orderDate:t.orderForm.orderDate,purchasing:t.orderForm.purchasing,productId:t.orderForm.productId,receivables:t.orderForm.receivables,billingDate:t.orderForm.billingDate,actuallyArrived:t.orderForm.actuallyArrived,paymentDate:t.orderForm.paymentDate,production:t.orderForm.production,followUpTypeId:t.orderForm.followUpTypeId,shipDate:t.orderForm.shipDate,arrivalDate:t.orderForm.arrivalDate,waybillNumber:t.orderForm.waybillNumber,shipping:t.orderForm.shipping,courierCompany:t.orderForm.courierCompany}).then(function(e){console.log("order    "+e),"1"===e.data.status?(t.$message({message:e.data.msg,type:"success"}),t.loadingData(),t.addModalFlag=!1,t.resetForm("orderForm")):t.$message.error(e.data.msg)})})},showRemoveModal:function(e,t){this.removeModalFlag=!0,this.orderId=t._id},handleDelete:function(){var e=this;this.$ajax.delete("/order/del/"+this.orderId,{params:{id:this.orderId}}).then(function(t){"1"===t.data.status?(e.$message({message:t.data.msg,type:"success"}),e.loadingData(),e.removeModalFlag=!1):e.removeModalFlag=!1})},formatDate:function(e){var t=new Date(e);return t.getFullYear()+"-"+(t.getMonth()<10?"0"+t.getMonth():t.getMonth())+"-"+(t.getDay()<10?"0"+t.getDay():t.getDay())},resetForm:function(e){this.$refs[e].resetFields()}}},i={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-row",{staticClass:"source"},[r("el-col",{attrs:{span:12}},[r("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[r("el-breadcrumb-item",{attrs:{to:{path:"/admin"}}},[e._v("首页")]),e._v(" "),r("el-breadcrumb-item",[e._v("订单列表")])],1)],1),e._v(" "),r("el-col",{attrs:{span:1,offset:10}},[r("el-button",{attrs:{type:"success",size:"mini"},on:{click:e.addModal}},[e._v("添加")])],1)],1),e._v(" "),r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingFlag,expression:"loadingFlag"}],staticStyle:{width:"100%"},attrs:{"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading",data:e.tableData,stripe:""},on:{"selection-change":e.handleSelectionChange}},[e._v(">\n    "),r("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),r("el-table-column",{attrs:{prop:"contractNo",label:"合同号",width:"200"}}),e._v(" "),r("el-table-column",{attrs:{prop:"sales",label:"销售代表",width:"200"}}),e._v(" "),r("el-table-column",{attrs:{prop:"clientName",label:"客户名称",width:"200"}}),e._v(" "),r("el-table-column",{attrs:{prop:"clientType",label:"客户类型",width:"200"}}),e._v(" "),r("el-table-column",{attrs:{prop:"orderDate",label:"订购日期",width:"200"}}),e._v(" "),r("el-table-column",{attrs:{prop:"productName",label:"品名",width:"200"}}),e._v(" "),r("el-table-column",{attrs:{prop:"productNum",label:"数量",width:"200"}}),e._v(" "),r("el-table-column",{attrs:{prop:"productPrice",label:"单价",width:"200"}}),e._v(" "),r("el-table-column",{attrs:{prop:"receivables",label:"应收金额",width:"200"}}),e._v(" "),r("el-table-column",{attrs:{prop:"billingDate",label:"开票日期",width:"200"}}),e._v(" "),r("el-table-column",{attrs:{prop:"actuallyArrived",label:"实际到账",width:"200"}}),e._v(" "),r("el-table-column",{attrs:{prop:"paymentDate",label:"收款日期",width:"200"}}),e._v(" "),r("el-table-column",{attrs:{prop:"production",label:"生产下单",width:"200"}}),e._v(" "),r("el-table-column",{attrs:{prop:"followUpType",label:"跟单类型",width:"200"}}),e._v(" "),r("el-table-column",{attrs:{prop:"shipDate",label:"发货日期",width:"200"}}),e._v(" "),r("el-table-column",{attrs:{prop:"arrivalDate",label:"到货日期",width:"200"}}),e._v(" "),r("el-table-column",{attrs:{prop:"waybillNumber",label:"运单号",width:"200"}}),e._v(" "),r("el-table-column",{attrs:{prop:"shipping",label:"运费",width:"200"}}),e._v(" "),r("el-table-column",{attrs:{prop:"courierCompany",label:"快递公司",width:"200"}}),e._v(" "),r("el-table-column",{attrs:{prop:"createdAt",label:"创建时间",width:"200"}}),e._v(" "),r("el-table-column",{attrs:{prop:"updatedAt",label:"更新时间",width:"200"}}),e._v(" "),r("el-table-column",{attrs:{fixed:"right",label:"操作",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(r){e.showEditModal(t.$index,t.row)}}},[e._v("编辑")]),e._v(" "),r("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(r){e.showRemoveModal(t.$index,t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),r("pagination",{attrs:{total:e.total,pageCount:e.pageCount,currentPage:e.currentPage,pageSize:e.pageSize},on:{clickpageNum:e.clickpageNum}}),e._v(" "),r("modal",{staticClass:"modal",attrs:{dialogFormVisible:e.addModalFlag,title:"新增",width:e.modalWidth},on:{modalToggle:e.modalChange}},[r("el-form",{ref:"orderForm",attrs:{slot:"content",model:e.orderForm,rules:e.rules,"label-width":e.formLabelWidth},slot:"content"},[r("el-form-item",{attrs:{label:"合同号",prop:"contractNo"}},[r("el-input",{model:{value:e.orderForm.contractNo,callback:function(t){e.$set(e.orderForm,"contractNo",t)},expression:"orderForm.contractNo"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"销售代表",prop:"salesId"}},[r("el-select",{attrs:{placeholder:"请选择"},on:{change:function(t){e.selectedSalesKey(t)}},model:{value:e.orderForm.salesId,callback:function(t){e.$set(e.orderForm,"salesId",t)},expression:"orderForm.salesId"}},e._l(e.salesArr,function(t){return r("el-option",{key:t._id,attrs:{label:t.account,value:t._id}},[r("span",{staticStyle:{float:"left"}},[e._v(e._s(t.account))])])}))],1),e._v(" "),r("el-form-item",{attrs:{label:"客户名称",prop:"clientNameId"}},[r("el-select",{attrs:{placeholder:"请选择"},on:{change:function(t){e.selectedClientNameKey(t)}},model:{value:e.orderForm.clientNameId,callback:function(t){e.$set(e.orderForm,"clientNameId",t)},expression:"orderForm.clientNameId"}},e._l(e.clientNameArr,function(t){return r("el-option",{key:t._id,attrs:{label:t.clientName,value:t._id}},[r("span",{staticStyle:{float:"left"}},[e._v(e._s(t.clientName))])])}))],1),e._v(" "),r("el-form-item",{attrs:{label:"客户类型",prop:"clientTypeId"}},[r("el-select",{attrs:{placeholder:"请选择"},on:{change:function(t){e.selectedClientTypeKey(t)}},model:{value:e.orderForm.clientTypeId,callback:function(t){e.$set(e.orderForm,"clientTypeId",t)},expression:"orderForm.clientTypeId"}},e._l(e.clientTypeArr,function(t){return r("el-option",{key:t._id,attrs:{label:t.clientType,value:t._id}},[r("span",{staticStyle:{float:"left"}},[e._v(e._s(t.clientType))])])}))],1),e._v(" "),r("el-form-item",{attrs:{label:"订购日期",prop:"orderDate"}},[r("el-date-picker",{attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},on:{change:e.getOrderDade},model:{value:e.orderForm.orderDate,callback:function(t){e.$set(e.orderForm,"orderDate",t)},expression:"orderForm.orderDate"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"当日配送"}},[r("el-switch",{model:{value:e.orderForm.delivery,callback:function(t){e.$set(e.orderForm,"delivery",t)},expression:"orderForm.delivery"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"订购次数",prop:"purchasing"}},[r("el-input-number",{attrs:{disabled:!0},on:{change:e.handlePurchasingChange},model:{value:e.orderForm.receivables,callback:function(t){e.$set(e.orderForm,"receivables",t)},expression:"orderForm.receivables"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"产品名称",prop:"producId"}},[r("el-select",{attrs:{placeholder:"请选择"},on:{change:function(t){e.selectedProductKey(t)}},model:{value:e.orderForm.producId,callback:function(t){e.$set(e.orderForm,"producId",t)},expression:"orderForm.producId"}},e._l(e.productArr,function(t){return r("el-option",{key:t._id,attrs:{label:t.productName,value:t._id}},[r("span",{staticStyle:{float:"left"}},[e._v(e._s(t.productName))])])}))],1),e._v(" "),r("el-form-item",{attrs:{label:"应收金额",prop:"receivables"}},[r("el-input",{model:{value:e.orderForm.receivables,callback:function(t){e.$set(e.orderForm,"receivables",t)},expression:"orderForm.receivables"}},[r("template",{attrs:{slot:"append"},slot:"append"},[e._v("元")])],2)],1),e._v(" "),r("el-form-item",{attrs:{label:"实际到帐",prop:"actuallyArrived"}},[r("el-input",{model:{value:e.orderForm.actuallyArrived,callback:function(t){e.$set(e.orderForm,"actuallyArrived",t)},expression:"orderForm.actuallyArrived"}},[r("template",{attrs:{slot:"append"},slot:"append"},[e._v("元")])],2)],1),e._v(" "),r("el-form-item",{attrs:{label:"开票日期",prop:"billingDate"}},[r("el-date-picker",{attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},on:{change:e.getBillingDate},model:{value:e.orderForm.billingDate,callback:function(t){e.$set(e.orderForm,"billingDate",t)},expression:"orderForm.billingDate"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"到账日期",prop:"paymentDate"}},[r("el-date-picker",{attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},on:{change:e.getPaymentDate},model:{value:e.orderForm.paymentDate,callback:function(t){e.$set(e.orderForm,"paymentDate",t)},expression:"orderForm.paymentDate"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"生产下单",prop:"production"}},[r("el-input",{model:{value:e.orderForm.production,callback:function(t){e.$set(e.orderForm,"production",t)},expression:"orderForm.production"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"跟单类型",prop:"followUpTypeId"}},[r("el-select",{attrs:{placeholder:"请选择"},on:{change:function(t){e.selectedFollowUpTypeKey(t)}},model:{value:e.orderForm.followUpTypeId,callback:function(t){e.$set(e.orderForm,"followUpTypeId",t)},expression:"orderForm.followUpTypeId"}},e._l(e.followUpTypeArr,function(t){return r("el-option",{key:t._id,attrs:{label:t.orderType,value:t._id}},[r("span",{staticStyle:{float:"left"}},[e._v(e._s(t.orderType))])])}))],1),e._v(" "),r("el-form-item",{attrs:{label:"发货日期",prop:"shipDate"}},[r("el-date-picker",{attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},on:{change:e.getShipDate},model:{value:e.orderForm.shipDate,callback:function(t){e.$set(e.orderForm,"shipDate",t)},expression:"orderForm.shipDate"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"到货日期",prop:"arrivalDate"}},[r("el-date-picker",{attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},on:{change:e.getArrivalDate},model:{value:e.orderForm.arrivalDate,callback:function(t){e.$set(e.orderForm,"arrivalDate",t)},expression:"orderForm.arrivalDate"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"运单号",prop:"waybillNumber"}},[r("el-input",{model:{value:e.orderForm.waybillNumber,callback:function(t){e.$set(e.orderForm,"waybillNumber",t)},expression:"orderForm.waybillNumber"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"运费",prop:"shipping"}},[r("el-input",{model:{value:e.orderForm.shipping,callback:function(t){e.$set(e.orderForm,"shipping",t)},expression:"orderForm.shipping"}},[r("template",{attrs:{slot:"append"},slot:"append"},[e._v("元")])],2)],1),e._v(" "),r("el-form-item",{attrs:{label:"快递公司",prop:"courierCompany"}},[r("el-input",{model:{value:e.orderForm.courierCompany,callback:function(t){e.$set(e.orderForm,"courierCompany",t)},expression:"orderForm.courierCompany"}})],1)],1),e._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{type:"danger","native-type":"reset"},on:{click:function(t){e.resetForm("orderForm")}}},[e._v("重置")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addOrder("orderForm")}}},[e._v("保存")])],1)],1),e._v(" "),r("modal",{attrs:{dialogFormVisible:e.removeModalFlag},on:{modalToggle:e.modalChange}},[r("p",{staticStyle:{"text-align":"center","font-size":"20px"},attrs:{slot:"content"},slot:"content"},[e._v("\n          是否删除订单？\n      ")]),e._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:e.modalChange}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"danger"},on:{click:e.handleDelete}},[e._v("确 定")])],1)])],1)},staticRenderFns:[]};var n=r("46Yf")(l,i,!1,function(e){r("sesR")},"data-v-a4514cce",null);t.default=n.exports},sesR:function(e,t){}});
//# sourceMappingURL=8.73c4aa5a419f3b0457a0.js.map